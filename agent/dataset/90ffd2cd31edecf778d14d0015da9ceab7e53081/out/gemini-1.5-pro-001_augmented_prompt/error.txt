Traceback (most recent call last):
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 76, in error_remapped_callable
    return callable_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/grpc/_channel.py", line 1181, in __call__
    return _end_unary_response_blocking(state, call, False, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/grpc/_channel.py", line 1006, in _end_unary_response_blocking
    raise _InactiveRpcError(state)  # pytype: disable=not-instantiable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
grpc._channel._InactiveRpcError: <_InactiveRpcError of RPC that terminated with:
	status = StatusCode.INTERNAL
	details = "Internal error occurred."
	debug_error_string = "UNKNOWN:Error received from peer ipv6:%5B2a00:1450:4001:81d::200a%5D:443 {grpc_message:"Internal error occurred.", grpc_status:13, created_time:"2024-08-03T14:34:03.22518415+00:00"}"
>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/thesis/masterthesis-implementation-gpt/langchain-agent.py", line 973, in <module>
    first_shot_state = app.invoke(
                       ^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 1554, in invoke
    for chunk in self.stream(
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 1073, in stream
    _panic_or_proceed(done, inflight, step)
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 1643, in _panic_or_proceed
    raise exc
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langgraph/pregel/retry.py", line 72, in run_with_retry
    task.proc.invoke(task.input, task.config)
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 2502, in invoke
    input = step.invoke(input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langgraph/utils.py", line 95, in invoke
    ret = context.run(self.func, input, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/langchain-agent.py", line 924, in call_model
    response = llm_with_tools.invoke(messages)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 4573, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 170, in invoke
    self.generate_prompt(
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 599, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 456, in generate
    raise e
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 446, in generate
    self._generate_with_cache(
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 671, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_google_vertexai/chat_models.py", line 729, in _generate
    return self._generate_gemini(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_google_vertexai/chat_models.py", line 819, in _generate_gemini
    response = _completion_with_retry(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_google_vertexai/chat_models.py", line 567, in _completion_with_retry
    return _completion_with_retry_inner(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 336, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/langchain_google_vertexai/chat_models.py", line 560, in _completion_with_retry_inner
    return generation_method(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/google/cloud/aiplatform_v1beta1/services/prediction_service/client.py", line 2287, in generate_content
    response = rpc(
               ^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/thesis/masterthesis-implementation-gpt/.venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InternalServerError: 500 Internal error occurred.
